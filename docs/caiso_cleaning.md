# Cleaning FERC Data that covers CAISO Assets

In order to align FERC data up with CAISO's generation resource data, we need
to modify the raw data a little bit. This file documents those steps.

1. Clean the seller names. This entails
    1. Trimming leading and trailing whitespace
    2. Removing internal whitespace to single spaces
    3. Removing any commas or periods
    4. Sending to lowercase
2. Fix a few known anomalies in the `point_of_delivery_specific_location`
    (aka `podsl`) column. These come down to:
    1. The seller "Vista Energy Storage, LLC" seems to use a different
        node address for every single one of their transactions, although
        they all begin with `VSTAES_6_VESBT`, which is **almost** the
        **resource** id of their single CAISO battery (the actual resource
        id is `VSTAES_6_VESBT1`; the node id is `Q1061COL_7_N001`). The
        remaining characters of the node address in the FERC data are 4-5
        decimal characters.
            To fix this headache, wherever "Vista Energy Storage, LLC" is
        listed as the seller, we'll overwrite the node id to be
        `VSTAES_6_VESBT1` to accord with the CAISO generation master list.
    2. The same problem happens with "Placerita ESS, LLC". Their `podsl`
        column is overwritten to `NOAKS_2_PESBT1`; their asset's generation
        ID.
3. When reading in the CAISO `ATL_GEN_CAP_LST` (the master list of generating
        resources in the ISO), we add node ID information.
    1. This means we read in CAISO's `ATL_RESOURCE` dataset and merge based
        on the unit resource ID and the unit's parent resource ID
    2. However this approach that uses both unit resource and parent resource
        ID means that there are duplicate `node_id` entries. This would cause
        headaches when merging the master list to the FERC datsets
    3. All of these duplicate `node_id` entries are removed by the following
        filtering operation:
        1. Keep resources with `resource_agg_type == N` OR
        2. Keep resources with `resource_agg_type == Y` AND
            `classification == 'Participating Unit'`

# Matching FERC and CAISO Data

After performing the following cleaning operations, matching keys are
consecutively generated by each of the following approaches.

1. Match `resource_id` from CAISO's master list to the `podsl` FERC column.
2. Match `node_id` from CAISO's master list and resource node list to the
    `podsl` FERC column.
3. Restrict the master list to resources whose owner solely owns that one
    resource (i.e. its owner is a single purpose vehicle). Then match
    `owner_or_qf` from CAISO's master list to the `seller_company_name`
    FERC column
